{
    "execution_plan": [
        {
            "id": 1,
            "description": "Find distinct customers (email and full_name) who have at least one order in the EU database (orders in EUR).",
            "database": "postgresql+psycopg://eu_user:eu_pass@localhost:5437/sales_eu",
            "query": "SELECT DISTINCT customers.email AS s1__email, customers.full_name AS s1__full_name FROM customers JOIN orders ON customers.id = orders.customer_id;",
            "depends_on": [],
            "output_columns": [
                {
                    "alias": "s1__email",
                    "source": "customers.email"
                },
                {
                    "alias": "s1__full_name",
                    "source": "customers.full_name"
                }
            ],
            "join_info": null
        },
        {
            "id": 2,
            "description": "Find distinct customers (email and full_name) who have at least one order in the US database (orders in USD) and keep only those whose email appears in the EU results (customers with orders in both currencies).",
            "database": "postgresql+psycopg://us_user:us_pass@localhost:5438/sales_us",
            "query": "SELECT DISTINCT customers.email AS s2__email, customers.full_name AS s2__full_name FROM customers JOIN orders ON customers.id = orders.customer_id WHERE customers.email IN ($step1.s1__email);",
            "depends_on": [
                1
            ],
            "output_columns": [
                {
                    "alias": "s2__email",
                    "source": "customers.email"
                },
                {
                    "alias": "s2__full_name",
                    "source": "customers.full_name"
                }
            ],
            "join_info": {
                "type": "INNER",
                "on": {
                    "current_step_column": "s2__email",
                    "dependency_step_column": "s1__email"
                }
            }
        }
    ],
    "final_output_columns": [
        "s1__email",
        "s1__full_name",
        "s2__full_name"
    ],
    "final_aggregation": {
        "type": "NONE",
        "column": "",
        "distinct": false,
        "group_by": []
    }
}